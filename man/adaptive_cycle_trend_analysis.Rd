% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/adaptive_cycle_trend_analysis.r
\name{adaptive_cycle_trend_analysis}
\alias{adaptive_cycle_trend_analysis}
\title{Adaptive Trend and Cycle Analysis for Time Series}
\usage{
adaptive_cycle_trend_analysis(
  signal,
  dates,
  normalize = FALSE,
  trendmethod = c("loess", "gam"),
  usefourier = FALSE,
  fourierK = 2,
  auto_fourier_select = TRUE,
  fourier_selection_criterion = c("AICc", "BIC"),
  fourierK_max = 6,
  cimethod = c("model", "bootstrapiid", "bootstrapmbb"),
  nboot = 1000,
  blocksize = NULL,
  seasonalfrequency = 7,
  stlrobust = TRUE,
  specspans = c(7, 7),
  auto_seasonality = TRUE,
  lagmax = NULL,
  loess_span_mode = c("auto_aicc", "auto_gcv", "cv", "fixed"),
  loess_span_fixed = NULL,
  loess_span_grid = seq(0.15, 0.6, by = 0.05),
  loess_cv_k = 5,
  blocklength_mode = c("auto_pwsd", "heuristic", "fixed"),
  blocklength_fixed = NULL,
  robust = TRUE,
  use_gamm = FALSE,
  group_var = NULL,
  group_values = NULL,
  random_effect = NULL,
  cor_struct = c("none", "ar1", "arma"),
  arma_p = 1,
  arma_q = 0,
  forecast_holdout_h = 0,
  forecast_origin_mode = c("expanding", "sliding"),
  train_window = NULL,
  forecast_lock_K = TRUE,
  exportdocx = FALSE,
  exportplot = FALSE,
  outputpath = "analysisreport.docx",
  logopath = NULL,
  logowidth = 1.5,
  logoheight = 0.5,
  project_id = NULL,
  cohort_id = NULL,
  assay_version = NULL,
  analyst = NULL,
  run_date = Sys.Date(),
  notes = NULL,
  include_parameters_appendix = TRUE
)
}
\arguments{
\item{signal}{Numeric vector of observed values.}

\item{dates}{Date vector of the same length as \code{signal}.}

\item{normalize}{Logical; if TRUE, Z score normalization is applied.}

\item{trendmethod}{Character; \code{"loess"} or \code{"gam"}.}

\item{usefourier}{Logical; whether to include Fourier harmonics.}

\item{fourierK}{Integer; fixed number of harmonics if auto selection disabled.}

\item{auto_fourier_select}{Logical; if TRUE, selects K via AICc/BIC.}

\item{fourier_selection_criterion}{\code{"AICc"} or \code{"BIC"}.}

\item{fourierK_max}{Maximum K to consider during selection.}

\item{cimethod}{\code{"model"}, \code{"bootstrapiid"}, or \code{"bootstrapmbb"}.}

\item{nboot}{Number of bootstrap samples.}

\item{blocksize}{Block size for MBB bootstrap.}

\item{seasonalfrequency}{Seasonal frequency for STL (regular sampling).}

\item{stlrobust}{Logical; robust STL decomposition.}

\item{specspans}{Smoothing spans for spectral estimation.}

\item{auto_seasonality}{Logical; if TRUE, uses dominant period.}

\item{lagmax}{Maximum lag for ACF and Ljung Box tests.}

\item{loess_span_mode}{\code{"auto_aicc"}, \code{"auto_gcv"}, \code{"cv"}, \code{"fixed"}.}

\item{loess_span_fixed}{Numeric; fixed LOESS span.}

\item{loess_span_grid}{Grid of spans for CV.}

\item{loess_cv_k}{Number of folds for blocked CV.}

\item{blocklength_mode}{\code{"auto_pwsd"}, \code{"heuristic"}, \code{"fixed"}.}

\item{blocklength_fixed}{Fixed block length.}

\item{robust}{Logical; robust LOESS or robust GAM family.}

\item{use_gamm}{Logical; fit GAMM instead of GAM.}

\item{group_var}{Character; grouping variable for random intercepts.}

\item{group_values}{Optional vector to attach as grouping variable.}

\item{random_effect}{Optional random effects list for \code{mgcv::gamm}.}

\item{cor_struct}{\code{"none"}, \code{"ar1"}, \code{"arma"}.}

\item{arma_p, arma_q}{ARMA orders.}

\item{forecast_holdout_h}{Holdout horizon for forecasting.}

\item{forecast_origin_mode}{\code{"expanding"} or \code{"sliding"}.}

\item{train_window}{Training window for sliding origin.}

\item{forecast_lock_K}{Logical; lock Fourier K across origins.}

\item{exportdocx}{Logical; export DOCX report.}

\item{exportplot}{Logical; export plots.}

\item{outputpath}{Path for DOCX export.}

\item{logopath}{Optional logo for DOCX.}

\item{logowidth, logoheight}{Logo dimensions.}

\item{project_id, cohort_id, assay_version, analyst, run_date, notes}{Metadata.}

\item{include_parameters_appendix}{Logical; include appendix in DOCX.}
}
\value{
A list containing:
\itemize{
\item Trend estimates
\item Confidence intervals
\item Residuals and diagnostics
\item Fourier selection results
\item Change-point locations
\item Spectral analysis
\item Forecast results (if enabled)
\item ggplot2 objects for visualization
}
}
\description{
Performs adaptive trend estimation, cycle detection, Fourier harmonic
selection, bootstrap confidence intervals, change points detection, and
rolling-origin forecasting. Supports LOESS, GAM, and GAMM models, and
automatically handles irregular sampling using the Lomb Scargle periodogram.
}
\examples{
\dontrun{
set.seed(1)
dates <- as.Date("2020-01-01") + cumsum(sample(1:3, 300, replace = TRUE))
signal <- sin(2*pi*as.numeric(dates)/20) + rnorm(300, 0, 0.3)

# GAM trend with Fourier harmonics
res_gam <- adaptive_cycle_trend_analysis(
  signal = signal,
  dates = dates,
  usefourier = TRUE,
  trendmethod = "gam"
)
}

\dontrun{
set.seed(1)
dates <- as.Date("2020-01-01") + cumsum(sample(1:3, 150, replace = TRUE))
signal <- sin(2*pi*as.numeric(dates)/25) + rnorm(150, 0, 0.3)
group  <- rep(letters[1:4], length.out = length(signal))

# GAMM trend with random intercepts
res_gamm <- adaptive_cycle_trend_analysis(
  signal = signal,
  dates = dates,
  trendmethod = "gam",
  use_gamm = TRUE,
  group_var = "subject",
  group_values = group,
  usefourier = FALSE,   # keeps example fast
  nboot = 20            # reduced for CRAN
)

plot(res_gamm$Plot$Trend)
}
\dontrun{
set.seed(1)
dates <- as.Date("2020-01-01") + 1:120
signal <- sin(2*pi*(1:120)/20) + rnorm(120, 0, 0.2)

# LOESS trend with automatic Fourier selection
res_loess <- adaptive_cycle_trend_analysis(
  signal = signal,
  dates = dates,
  trendmethod = "loess",
  usefourier = TRUE,
  auto_fourier_select = TRUE,
  nboot = 50   # reduced for speed in examples
)

plot(res_loess$Plot$Trend)
}
}
